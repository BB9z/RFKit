language: objective-c
sudo: false
cache: cocoapods
env:
  global:
  - LC_CTYPE=en_US.UTF-8
  - LANG=en_US.UTF-8
  - LANGUAGE=en_US.UTF-8
matrix:
  include:
    - osx_image: xcode9.3
      env: XB_DEST_iOS="platform=iOS Simulator,name=iPhone X,OS=11.3" XB_DEST_tvOS="platform=tvOS Simulator,name=Apple TV 4K,OS=11.3" TEST_SWIFT=1 POD_LINT=1
    - osx_image: xcode9.3
      env: XB_DEST_iOS="platform=iOS Simulator,name=iPhone 4s,OS=8.1" XB_DEST_tvOS="platform=tvOS Simulator,name=Apple TV,OS=9.0" TEST_SWIFT=1
    - osx_image: xcode8.3
      env: XB_DEST_iOS="platform=iOS Simulator,name=iPhone 6,OS=10.2" XB_DEST_tvOS="platform=tvOS Simulator,name=Apple TV 1080p,OS=10.2"
before_install:
# - gem install cocoapods --no-rdoc --no-ri --no-document --quiet
- pod repo update master --silent
- pod install --project-directory=Test
script:
- set -o pipefail
- if [ 1 = "$TEST_SWIFT" ]; then xcodebuild test -workspace Test/RFKit.xcworkspace -scheme Test-Swift -destination "$XB_DEST_iOS" | xcpretty; fi
- xcodebuild test -enableCodeCoverage YES -workspace Test/RFKit.xcworkspace -scheme Test-iOS -destination "$XB_DEST_iOS" ONLY_ACTIVE_ARCH=NO | xcpretty
- xcodebuild test -enableCodeCoverage YES -workspace Test/RFKit.xcworkspace -scheme Test-tvOS -destination "$XB_DEST_tvOS" ONLY_ACTIVE_ARCH=NO | xcpretty
- xcodebuild build -workspace Test/RFKit.xcworkspace -scheme Target-watchOS ONLY_ACTIVE_ARCH=NO | xcpretty
- if [ 1 = "$POD_LINT" ]; then pod lib lint --allow-warnings; fi
after_failure:
 - cat -n ~/Library/Logs/DiagnosticReports/xctest*.crash
